<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.obc.modules.sys.dao.BcSysUserDao">
    <sql id="UserColumns">
        bsu.sys_user_id,
        bsu.password,
        bsu.salt,
        bsu.username,
        bsu.email,
        bsu.nickname,
        bsu.mobile_phone,
        bsu.create_time,
        bsu.last_login_time,
        bsu.is_valid
    </sql>
    <resultMap type="bcSysUser" id="userResult">
        <id property="sys_user_id" column="sys_user_id" />
        <result property="password" column="password" />
        <result property="salt" column="salt" />
        <result property="username" column="email" />
        <result property="nickname" column="nickname" />
        <result property="mobile_phone" column="mobile_phone" />
        <result property="create_time" column="create_time" />
        <result property="last_login_time" column="last_login_time" />
        <result property="is_valid" column="is_valid" />
    </resultMap>
    <select id="findBcSysUser" parameterType="java.lang.String" resultType="bcSysUser">
        select
        <include refid="UserColumns" />
        from bc_sys_user bsu where bsu.mobile_phone=#{username } or bsu.email=#{username }
    </select>
    <!-- 注册 -->
    <insert id="addBcSysUser" parameterType="bcSysUser" useGeneratedKeys="true" keyProperty="sys_user_id">
        INSERT INTO bc_sys_user
        (password,salt,username,email,nickname,mobile_phone,create_time,last_login_time,is_valid)
        VALUES
        (#{password}, #{salt}, #{username}, #{email}, #{nickname}, #{mobile_phone},
        #{create_time}, #{last_login_time}, #{is_valid})
    </insert>
    <!-- 更新 -->
    <update id="updateBcSysUser" parameterType="bcSysUser">
        UPDATE bc_sys_user bsu
        <set>
            <if test="password!=null and password!=''">bsu.password=#{password},</if>
            <if test="salt!=null and salt!=''">bsu.salt=#{salt},</if>
            <if test="username!=null and username!=''">bsu.username=#{username},</if>
            <if test="email!=null and email!=''">bsu.email=#{email},</if>
            <if test="nickname!=null and nickname!=''">bsu.nickname=#{nickname},</if>
            <if test="mobile_phone!=null and mobile_phone!=''">bsu.mobile_phone=#{mobile_phone},</if>
            <if test="create_time!=null and create_time!=''">bsu.create_time=#{create_time},</if>
            <if test="last_login_time!=null and last_login_time!=''">bsu.last_login_time=#{last_login_time},</if>
            <if test="is_valid!=null and is_valid!=''">bsu.is_valid=#{is_valid}</if>
        </set>
        <where>
            sys_user_id=#{sys_user_id}
        </where>

    </update>
</mapper>